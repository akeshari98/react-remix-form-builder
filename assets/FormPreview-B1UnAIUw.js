import{r as l,n as e,w as V}from"./components-CI4-KR-R.js";import{u as R}from"./formStore-B0pwvZwb.js";import{B as g,F as P}from"./Button-BK87y0HW.js";import{c as u}from"./clsx-B-dksMZM.js";const B=(r,t)=>{if(r.required&&(t==null||t===""))return`${r.label} is required`;if(t==null||t==="")return null;if(typeof t=="string"){if(r.minLength!==void 0&&t.length<r.minLength)return`${r.label} must be at least ${r.minLength} characters`;if(r.maxLength!==void 0&&t.length>r.maxLength)return`${r.label} must be at most ${r.maxLength} characters`;if(r.pattern&&!new RegExp(r.pattern).test(t))return`${r.label} is not in the correct format`;if(r.type==="email"&&!/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(t))return"Please enter a valid email address";if(r.type==="phone"&&!/^\+?[0-9\s\-()]{7,}$/.test(t))return"Please enter a valid phone number"}return null},q=(r,t)=>{const o={};return r.forEach(c=>{const d=t[c.id],m=B(c,d);m&&(o[c.id]=m)}),o},O=({form:r,isPublic:t=!1,onSubmit:o})=>{const{currentForm:c,currentStep:d,setCurrentStep:m,previewMode:w}=R(),a=r||c,[p,b]=l.useState({}),[y,x]=l.useState({}),[N,f]=l.useState(!1),[n,h]=l.useState(t?0:d);if(l.useEffect(()=>{t||h(d)},[d,t]),l.useEffect(()=>{b({}),x({}),f(!1)},[a==null?void 0:a.id]),!a)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No form to preview. Please create or select a form first."})});const v=a.steps[n],S=(s,i)=>{b(j=>({...j,[s]:i})),y[s]&&x(j=>({...j,[s]:null}))},k=()=>{const s=q(v.fields,p);return x(s),Object.keys(s).length===0},F=()=>{k()&&n<a.steps.length-1&&(h(n+1),t||m(n+1))},C=()=>{n>0&&(h(n-1),t||m(n-1))},L=s=>{s.preventDefault(),k()&&(f(!0),o&&o(p))},E=()=>{switch(w){case"mobile":return"max-w-[320px] w-full";case"tablet":return"max-w-[768px] w-full";case"desktop":default:return"max-w-[1024px] w-full"}},$=()=>{switch(w){case"mobile":return"p-3 bg-gray-800 rounded-[24px] shadow-lg";case"tablet":return"p-4 bg-gray-800 rounded-[16px] shadow-lg";case"desktop":default:return""}};return e.jsx("div",{className:u("mx-auto transition-all duration-300",E()),children:e.jsx("div",{className:u($(),"transition-all duration-300"),children:e.jsx("div",{className:"bg-white rounded-md shadow-sm border border-gray-200 overflow-hidden dark:bg-gray-800 dark:border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.title}),a.description&&e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:a.description}),a.steps.length>1&&e.jsx("div",{className:"mt-6 mb-4",children:e.jsx("div",{className:"flex items-center justify-between",children:a.steps.map((s,i)=>e.jsxs(V.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:u("w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium",i<n?"bg-blue-600 text-white":i===n?"bg-blue-100 text-blue-600 border-2 border-blue-600 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-500 dark:bg-gray-700 dark:text-gray-400"),children:i+1}),e.jsx("span",{className:u("mt-1 text-xs",i===n?"text-blue-600 font-medium dark:text-blue-400":"text-gray-500 dark:text-gray-400"),children:s.title})]}),i<a.steps.length-1&&e.jsx("div",{className:u("flex-1 h-0.5 mx-2",i<n?"bg-blue-600":"bg-gray-200 dark:bg-gray-700")})]},s.id))})}),N?e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 text-green-600 mb-4 dark:bg-green-900 dark:text-green-200",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Form Submitted Successfully!"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:"Thank you for submitting the form."}),t&&e.jsx(g,{onClick:()=>{b({}),x({}),f(!1),h(0)},className:"mt-4",children:"Submit Another Response"})]}):e.jsxs("form",{onSubmit:L,className:"mt-6",children:[e.jsx("div",{className:"space-y-4",children:v.fields.map(s=>e.jsx(P,{field:s,value:p[s.id]||"",onChange:i=>S(s.id,i),error:y[s.id],isPreview:!0},s.id))}),e.jsxs("div",{className:"mt-8 flex justify-between",children:[n>0?e.jsx(g,{type:"button",onClick:C,variant:"secondary",children:"Previous"}):e.jsx("div",{}),n<a.steps.length-1?e.jsx(g,{type:"button",onClick:F,children:"Next"}):e.jsx(g,{type:"submit",children:"Submit"})]})]})]})})})})};export{O as F};
