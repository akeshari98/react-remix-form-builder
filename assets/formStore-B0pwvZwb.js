import{w as A}from"./components-CI4-KR-R.js";const O=n=>{let i;const e=new Set,r=(m,F)=>{const p=typeof m=="function"?m(i):m;if(!Object.is(p,i)){const S=i;i=F??(typeof p!="object"||p===null)?p:Object.assign({},i,p),e.forEach(g=>g(i,S))}},t=()=>i,d={setState:r,getState:t,getInitialState:()=>a,subscribe:m=>(e.add(m),()=>e.delete(m))},a=i=n(r,t,d);return d},T=n=>n?O(n):O,E=n=>n;function N(n,i=E){const e=A.useSyncExternalStore(n.subscribe,()=>i(n.getState()),()=>i(n.getInitialState()));return A.useDebugValue(e),e}const U=n=>{const i=T(n),e=r=>N(i,r);return Object.assign(e,i),e},J=n=>n?U(n):U;function j(n,i){let e;try{e=n()}catch{return}return{getItem:t=>{var o;const u=a=>a===null?null:JSON.parse(a,void 0),d=(o=e.getItem(t))!=null?o:null;return d instanceof Promise?d.then(u):u(d)},setItem:(t,o)=>e.setItem(t,JSON.stringify(o,void 0)),removeItem:t=>e.removeItem(t)}}const I=n=>i=>{try{const e=n(i);return e instanceof Promise?e:{then(r){return I(r)(e)},catch(r){return this}}}catch(e){return{then(r){return this},catch(r){return I(r)(e)}}}},k=(n,i)=>(e,r,t)=>{let o={storage:j(()=>localStorage),partialize:s=>s,version:0,merge:(s,v)=>({...v,...s}),...i},u=!1;const d=new Set,a=new Set;let m=o.storage;if(!m)return n((...s)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),e(...s)},r,t);const F=()=>{const s=o.partialize({...r()});return m.setItem(o.name,{state:s,version:o.version})},p=t.setState;t.setState=(s,v)=>{p(s,v),F()};const S=n((...s)=>{e(...s),F()},r,t);t.getInitialState=()=>S;let g;const D=()=>{var s,v;if(!m)return;u=!1,d.forEach(f=>{var h;return f((h=r())!=null?h:S)});const y=((v=o.onRehydrateStorage)==null?void 0:v.call(o,(s=r())!=null?s:S))||void 0;return I(m.getItem.bind(m))(o.name).then(f=>{if(f)if(typeof f.version=="number"&&f.version!==o.version){if(o.migrate){const h=o.migrate(f.state,f.version);return h instanceof Promise?h.then(w=>[!0,w]):[!0,h]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,f.state];return[!1,void 0]}).then(f=>{var h;const[w,R]=f;if(g=o.merge(R,(h=r())!=null?h:S),e(g,!0),w)return F()}).then(()=>{y==null||y(g,void 0),g=r(),u=!0,a.forEach(f=>f(g))}).catch(f=>{y==null||y(void 0,f)})};return t.persist={setOptions:s=>{o={...o,...s},s.storage&&(m=s.storage)},clearStorage:()=>{m==null||m.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>D(),hasHydrated:()=>u,onHydrate:s=>(d.add(s),()=>{d.delete(s)}),onFinishHydration:s=>(a.add(s),()=>{a.delete(s)})},o.skipHydration||D(),g||S},C=k,l=[];for(let n=0;n<256;++n)l.push((n+256).toString(16).slice(1));function M(n,i=0){return(l[n[i+0]]+l[n[i+1]]+l[n[i+2]]+l[n[i+3]]+"-"+l[n[i+4]]+l[n[i+5]]+"-"+l[n[i+6]]+l[n[i+7]]+"-"+l[n[i+8]]+l[n[i+9]]+"-"+l[n[i+10]]+l[n[i+11]]+l[n[i+12]]+l[n[i+13]]+l[n[i+14]]+l[n[i+15]]).toLowerCase()}let b;const q=new Uint8Array(16);function H(){if(!b){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");b=crypto.getRandomValues.bind(crypto)}return b(q)}const _=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),x={randomUUID:_};function c(n,i,e){var t;if(x.randomUUID&&!n)return x.randomUUID();n=n||{};const r=n.random??((t=n.rng)==null?void 0:t.call(n))??H();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,M(r)}const P=()=>({id:c(),title:"Untitled Form",steps:[{id:c(),title:"Step 1",fields:[]}],createdAt:Date.now(),updatedAt:Date.now()}),L=()=>{if(typeof window<"u")try{const n=localStorage.getItem("form-builder-storage");if(n){const i=JSON.parse(n);if(i.state&&i.state.theme)return i.state.theme}if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}catch(n){console.error("Error reading theme from localStorage:",n)}return"light"},G=J()(C((n,i)=>({forms:[],responses:[],currentForm:null,currentStep:0,activeFieldId:null,isDragging:!1,previewMode:"desktop",theme:L(),activeFormId:null,templates:[],history:{past:[],future:[]},createForm:()=>{const e=P();n(r=>({forms:[...r.forms,e],currentForm:e,currentStep:0,activeFieldId:null,history:{past:[],future:[]}}))},updateForm:e=>{const r={...e,updatedAt:Date.now()};n(t=>{const o=[...t.history.past,t.currentForm];return{forms:t.forms.map(u=>u.id===e.id?r:u),currentForm:r,history:{past:o,future:[]}}})},deleteForm:e=>{n(r=>{var t;return{forms:r.forms.filter(o=>o.id!==e),currentForm:((t=r.currentForm)==null?void 0:t.id)===e?null:r.currentForm}})},setCurrentForm:e=>{const r=i().forms.find(t=>t.id===e)||null;n({currentForm:r,activeFormId:e,currentStep:0,activeFieldId:null,history:{past:[],future:[]}})},setActiveFormId:e=>{n({activeFormId:e})},duplicateForm:e=>{const r=i().forms.find(o=>o.id===e);if(!r)return;const t={...JSON.parse(JSON.stringify(r)),id:c(),title:`${r.title} (Copy)`,createdAt:Date.now(),updatedAt:Date.now()};n(o=>({forms:[...o.forms,t]}))},importForms:e=>{const r=e.map(t=>({...t,id:c(),createdAt:Date.now(),updatedAt:Date.now()}));n(t=>({forms:[...t.forms,...r]}))},resetCurrentForm:()=>{n({currentForm:null,currentStep:0,activeFieldId:null})},addStep:()=>{if(!i().currentForm)return;const e={id:c(),title:`Step ${i().currentForm.steps.length+1}`,fields:[]};n(r=>{if(!r.currentForm)return r;const t={...r.currentForm,steps:[...r.currentForm.steps,e],updatedAt:Date.now()};return{currentForm:t,forms:r.forms.map(o=>o.id===t.id?t:o)}})},updateStep:(e,r)=>{n(t=>{if(!t.currentForm)return t;const o=t.currentForm.steps.map(d=>d.id===e?{...d,title:r}:d),u={...t.currentForm,steps:o,updatedAt:Date.now()};return{currentForm:u,forms:t.forms.map(d=>d.id===u.id?u:d)}})},deleteStep:e=>{n(r=>{if(!r.currentForm||r.currentForm.steps.length<=1)return r;const t=r.currentForm.steps.filter(u=>u.id!==e),o={...r.currentForm,steps:t,updatedAt:Date.now()};return{currentForm:o,currentStep:Math.min(r.currentStep,t.length-1),forms:r.forms.map(u=>u.id===o.id?o:u)}})},setCurrentStep:e=>{n({currentStep:e})},addField:(e,r)=>{n(t=>{if(!t.currentForm)return t;const o={id:c(),type:r,label:`New ${r} field`,placeholder:"",required:!1,...r==="dropdown"||r==="radio"?{options:[{id:c(),label:"Option 1",value:"option1"},{id:c(),label:"Option 2",value:"option2"}]}:{}},u=t.currentForm.steps.map(a=>a.id===e?{...a,fields:[...a.fields,o]}:a),d={...t.currentForm,steps:u,updatedAt:Date.now()};return{currentForm:d,activeFieldId:o.id,forms:t.forms.map(a=>a.id===d.id?d:a)}})},updateField:(e,r)=>{n(t=>{if(!t.currentForm)return t;const o=t.currentForm.steps.map(d=>d.id===e?{...d,fields:d.fields.map(a=>a.id===r.id?r:a)}:d),u={...t.currentForm,steps:o,updatedAt:Date.now()};return{currentForm:u,forms:t.forms.map(d=>d.id===u.id?u:d)}})},deleteField:(e,r)=>{n(t=>{if(!t.currentForm)return t;const o=t.currentForm.steps.map(d=>d.id===e?{...d,fields:d.fields.filter(a=>a.id!==r)}:d),u={...t.currentForm,steps:o,updatedAt:Date.now()};return{currentForm:u,activeFieldId:t.activeFieldId===r?null:t.activeFieldId,forms:t.forms.map(d=>d.id===u.id?u:d)}})},reorderFields:(e,r,t)=>{n(o=>{if(!o.currentForm)return o;const u=o.currentForm.steps.find(p=>p.id===e);if(!u)return o;const d=[...u.fields],[a]=d.splice(r,1);d.splice(t,0,a);const m=o.currentForm.steps.map(p=>p.id===e?{...p,fields:d}:p),F={...o.currentForm,steps:m,updatedAt:Date.now()};return{currentForm:F,forms:o.forms.map(p=>p.id===F.id?F:p)}})},setActiveField:e=>{n({activeFieldId:e})},setDragging:e=>{n({isDragging:e})},setPreviewMode:e=>{n({previewMode:e})},loadTemplate:e=>{if(e==="contact-us"){const r={id:c(),title:"Contact Us",description:"Get in touch with our team",steps:[{id:c(),title:"Contact Information",fields:[{id:c(),type:"text",label:"Name",placeholder:"Enter your full name",required:!0},{id:c(),type:"email",label:"Email",placeholder:"Enter your email address",required:!0,pattern:"^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$"},{id:c(),type:"phone",label:"Phone",placeholder:"Enter your phone number",required:!1}]},{id:c(),title:"Message",fields:[{id:c(),type:"dropdown",label:"Subject",placeholder:"Select a subject",required:!0,options:[{id:c(),label:"General Inquiry",value:"general"},{id:c(),label:"Support",value:"support"},{id:c(),label:"Feedback",value:"feedback"}]},{id:c(),type:"textarea",label:"Message",placeholder:"Enter your message",required:!0,minLength:10,maxLength:500}]}],createdAt:Date.now(),updatedAt:Date.now()};n(t=>({forms:[...t.forms,r],currentForm:r,currentStep:0,activeFieldId:null}))}},saveAsTemplate:()=>{const e=i().currentForm;e&&i().saveFormAsTemplate(e.id,e.title,e.description||"")},saveFormAsTemplate:(e,r,t)=>{const o=i().forms.find(d=>d.id===e);if(!o)return;const u={...JSON.parse(JSON.stringify(o)),templateId:c(),title:r,description:t||""};n(d=>({templates:[...d.templates,u]}))},createFormFromTemplate:e=>{const r=i().templates.find(o=>o.templateId===e);if(!r)return;const t={...JSON.parse(JSON.stringify(r)),id:c(),templateId:void 0,createdAt:Date.now(),updatedAt:Date.now()};n(o=>({forms:[...o.forms,t],currentForm:t,activeFormId:t.id,currentStep:0}))},deleteTemplate:e=>{n(r=>({templates:r.templates.filter(t=>t.templateId!==e)}))},addResponse:(e,r)=>{const t={id:c(),formId:e,data:r,submittedAt:Date.now()};n(o=>({responses:[...o.responses,t]}))},getResponses:e=>i().responses.filter(r=>r.formId===e),toggleTheme:()=>{n(e=>{const r=e.theme==="light"?"dark":"light";return console.log("Toggling theme from",e.theme,"to",r),{theme:r}})},undo:()=>{n(e=>{if(e.history.past.length===0||!e.currentForm)return e;const r=[...e.history.past],t=r.pop();return t?{currentForm:t,forms:e.forms.map(o=>o.id===t.id?t:o),history:{past:r,future:[e.currentForm,...e.history.future]}}:e})},redo:()=>{n(e=>{if(e.history.future.length===0||!e.currentForm)return e;const[r,...t]=e.history.future;return r?{currentForm:r,forms:e.forms.map(o=>o.id===r.id?r:o),history:{past:[...e.history.past,e.currentForm],future:t}}:e})}}),{name:"form-builder-storage"}));export{G as u,c as v};
